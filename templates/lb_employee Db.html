<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Dashboard - SabKoKaam</title>
    <link rel="stylesheet" href="../static/css/lb_employee DB.css"/>
    <style>
        .location-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .location-prompt {
            background-color: white;
            padding: 24px;
            border-radius: 8px;
            max-width: 90%;
            width: 400px;
            text-align: center;
        }
        
        .location-prompt h2 {
            margin-top: 0;
        }
        
        .location-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
            margin-top: 16px;
        }
        
        .location-btn:hover {
            background-color: #45a049;
        }
        
        .location-status {
            margin-top: 16px;
            font-style: italic;
        }
        
        .job-location {
            cursor: pointer;
            color: #0066cc;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <!-- Location Permission Overlay -->
    <div class="location-overlay" id="locationOverlay">
        <div class="location-prompt">
            <h2>Enable Location</h2>
            <p>Please allow access to your location to see job opportunities near you and get directions.</p>
            <button id="enableLocationBtn" class="location-btn">Enable Location</button>
            <p id="locationStatus" class="location-status"></p>
        </div>
    </div>

    <div class="container">
        <div class="dashboard-header">
            <div class="welcome-message">
                <div class="welcome-text">
                    <h1>Welcome, Rajesh Kumar</h1>
                    <p>Here are your job suggestions based on your skills</p>
                </div>
                <div class="dashboard-avatar">RK</div>
            </div>
            
            <div class="dashboard-section">
                <h3>Your Selected Categories</h3>
                <div class="skill-categories">
                    <span class="skill-tag">Construction</span>
                    <span class="skill-tag">Carpentry</span>
                    <span class="skill-tag">Masonry</span>
                    <span class="skill-tag">Painting</span>
                </div>
            </div>
        </div>
        
        <div class="dashboard-section">
            <h2 class="section-title">Job Suggestions</h2>
            <div class="job-grid">
                <!-- Job Card 1 -->
                <div class="job-card">
                    <div class="job-header">
                        <div class="job-picture">üèóÔ∏è</div>
                        <h3 class="job-title">Construction Worker Needed</h3>
                        <p class="job-company">Sharma Constructions</p>
                    </div>
                    <div class="job-body">
                        <div class="job-detail">
                            <div class="job-icon">üí∞</div>
                            <div class="job-info">‚Çπ800 - ‚Çπ950 per day</div>
                        </div>
                        <div class="job-detail">
                            <div class="job-icon">‚è∞</div>
                            <div class="job-info">Full-time, 8 AM - 5 PM</div>
                        </div>
                        <div class="job-detail">
                            <div class="job-icon">üìç</div>
                            <div class="job-info job-location" data-location="Dadar, Mumbai, Maharashtra">Dadar, Mumbai, Maharashtra</div>
                        </div>
                        
                        <button type="button" class="submit-button" onclick="handleSubmit()">Submit</button>
                        <button class="apply-button" onclick="toggleContact(this)">Contact Employer</button>

                        
                        <div class="contact-info">
                            <div class="contact-item">
                                <div class="contact-icon">üë§</div>
                                <div class="contact-text">Mr. Anil Sharma</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üì±</div>
                                <div class="contact-text">+91 98765 43210</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üí¨</div>
                                <div class="contact-text">
                                    <a href="https://wa.me/919876543210">WhatsApp: +91 98765 43210</a>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üìß</div>
                                <div class="contact-text">sharma.constructions@example.com</div>
                            </div>
                        </div>
                    </div>
                    <div class="job-footer">
                        <div class="job-categories">
                            <span class="job-category">Construction</span>
                            <span class="job-category">Masonry</span>
                        </div>
                    </div>
                </div>
                
                <!-- Job Card 2 -->
                <div class="job-card">
                    <div class="job-header">
                        <div class="job-picture">ü™ö</div>
                        <h3 class="job-title">Skilled Carpenter Required</h3>
                        <p class="job-company">Home Interior Solutions</p>
                    </div>
                    <div class="job-body">
                        <div class="job-detail">
                            <div class="job-icon">üí∞</div>
                            <div class="job-info">‚Çπ1000 - ‚Çπ1200 per day</div>
                        </div>
                        <div class="job-detail">
                            <div class="job-icon">‚è∞</div>
                            <div class="job-info">Contract-based</div>
                        </div>
                        <div class="job-detail">
                            <div class="job-icon">üìç</div>
                            <div class="job-info job-location" data-location="Koregaon Park, Pune, Maharashtra">Koregaon Park, Pune, Maharashtra</div>
                        </div>
                        
                        <button type="button" class="submit-button" onclick="handleSubmit()">Submit</button>
                        <button class="apply-button" onclick="toggleContact(this)">Contact Employer</button>
                        
                        <div class="contact-info">
                            <div class="contact-item">
                                <div class="contact-icon">üë§</div>
                                <div class="contact-text">Mrs. Priya Desai</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üì±</div>
                                <div class="contact-text">+91 87654 32109</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üí¨</div>
                                <div class="contact-text">
                                    <a href="https://wa.me/918765432109">WhatsApp: +91 87654 32109</a>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üìß</div>
                                <div class="contact-text">home.interior@example.com</div>
                            </div>
                        </div>
                    </div>
                    <div class="job-footer">
                        <div class="job-categories">
                            <span class="job-category">Carpentry</span>
                        </div>
                    </div>
                </div>
                
                <!-- Job Card 3 -->
                <div class="job-card">
                    <div class="job-header">
                        <div class="job-picture">üé®</div>
                        <h3 class="job-title">Residential Painting Project</h3>
                        <p class="job-company">Vibrant Homes</p>
                    </div>
                    <div class="job-body">
                        <div class="job-detail">
                            <div class="job-icon">üí∞</div>
                            <div class="job-info">‚Çπ750 - ‚Çπ900 per day</div>
                        </div>
                        <div class="job-detail">
                            <div class="job-icon">‚è∞</div>
                            <div class="job-info">15-day project</div>
                        </div>
                        <div class="job-detail">
                            <div class="job-icon">üìç</div>
                            <div class="job-info job-location" data-location="Vashi, Navi Mumbai, Maharashtra">Vashi, Navi Mumbai, Maharashtra</div>
                        </div>
                        <button type="button" class="submit-button" onclick="handleSubmit()">Submit</button>
                        <button class="apply-button" onclick="toggleContact(this)">Contact Employer</button>
                        
                        <div class="contact-info">
                            <div class="contact-item">
                                <div class="contact-icon">üë§</div>
                                <div class="contact-text">Mr. Ravi Verma</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üì±</div>
                                <div class="contact-text">+91 76543 21098</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üí¨</div>
                                <div class="contact-text">
                                    <a href="https://wa.me/917654321098">WhatsApp: +91 76543 21098</a>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üìß</div>
                                <div class="contact-text">vibrant.homes@example.com</div>
                            </div>
                        </div>
                    </div>
                    <div class="job-footer">
                        <div class="job-categories">
                            <span class="job-category">Painting</span>
                            <span class="job-category">Construction</span>
                        </div>
                    </div>
                </div>
                
                <!-- Job Card 4 -->
                <div class="job-card">
                    <div class="job-header">
                        <div class="job-picture">üè¢</div>
                        <h3 class="job-title">Commercial Building Project</h3>
                        <p class="job-company">Mega Builders Ltd.</p>
                    </div>
                    <div class="job-body">
                        <div class="job-detail">
                            <div class="job-icon">üí∞</div>
                            <div class="job-info">‚Çπ850 - ‚Çπ1000 per day</div>
                        </div>
                        <div class="job-detail">
                            <div class="job-icon">‚è∞</div>
                            <div class="job-info">3-month contract</div>
                        </div>
                        <div class="job-detail">
                            <div class="job-icon">üìç</div>
                            <div class="job-info job-location" data-location="MIDC Aurangabad, Maharashtra">MIDC Aurangabad, Maharashtra</div>
                        </div>
                        <button type="button" class="submit-button" onclick="handleSubmit()">Submit</button>
                        <button class="apply-button" onclick="toggleContact(this)">Contact Employer</button>
                        
                        <div class="contact-info">
                            <div class="contact-item">
                                <div class="contact-icon">üë§</div>
                                <div class="contact-text">Mr. Suresh Patel</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üì±</div>
                                <div class="contact-text">+91 65432 10987</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üí¨</div>
                                <div class="contact-text">
                                    <a href="https://wa.me/916543210987">WhatsApp: +91 65432 10987</a>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon">üìß</div>
                                <div class="contact-text">mega.builders@example.com</div>
                            </div>
                        </div>
                    </div>
                    <div class="job-footer">
                        <div class="job-categories">
                            <span class="job-category">Construction</span>
                            <span class="job-category">Masonry</span>
                            <span class="job-category">Carpentry</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Variables to store user location
        let userLatitude;
        let userLongitude;
        let locationPermissionGranted = false;
        
        // DOM elements
        const locationOverlay = document.getElementById('locationOverlay');
        const enableLocationBtn = document.getElementById('enableLocationBtn');
        const locationStatus = document.getElementById('locationStatus');
        const jobLocations = document.querySelectorAll('.job-location');
        
        // Request user's location when button is clicked
        enableLocationBtn.addEventListener('click', requestLocation);
        
        // Function to request location
        function requestLocation() {
            locationStatus.textContent = "Requesting location access...";
            
            if (!navigator.geolocation) {
                locationStatus.textContent = "Geolocation is not supported by your browser";
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                // Success callback
                function(position) {
                    userLatitude = position.coords.latitude;
                    userLongitude = position.coords.longitude;
                    locationPermissionGranted = true;
                    locationStatus.textContent = "Location access granted!";
                    
                    // Hide overlay after a short delay
                    setTimeout(() => {
                        locationOverlay.style.display = "none";
                    }, 1500);
                },
                // Error callback
                function(error) {
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            locationStatus.textContent = "Location permission denied. Some features may not work.";
                            break;
                        case error.POSITION_UNAVAILABLE:
                            locationStatus.textContent = "Location information is unavailable.";
                            break;
                        case error.TIMEOUT:
                            locationStatus.textContent = "The request to get location timed out.";
                            break;
                        case error.UNKNOWN_ERROR:
                            locationStatus.textContent = "An unknown error occurred.";
                            break;
                    }
                    
                    // Hide overlay even if permission is denied after a longer delay
                    setTimeout(() => {
                        locationOverlay.style.display = "none";
                    }, 3000);
                }
            );
        }
        
        // Add click event listeners to all job locations
        jobLocations.forEach(location => {
            location.addEventListener('click', function() {
                const destinationAddress = this.getAttribute('data-location');
                openGoogleMapsDirections(destinationAddress);
            });
        });
        
        // Function to open Google Maps with directions
        function openGoogleMapsDirections(destination) {
            if (locationPermissionGranted && userLatitude && userLongitude) {
                // Use current location coordinates
                const origin = `${userLatitude},${userLongitude}`;
                const mapsUrl = `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${encodeURIComponent(destination)}&travelmode=driving`;
                window.open(mapsUrl, '_blank');
            } else {
                // Use generic "my location" which Google Maps will resolve on its end
                const mapsUrl = `https://www.google.com/maps/dir/?api=1&origin=my+location&destination=${encodeURIComponent(destination)}&travelmode=driving`;
                window.open(mapsUrl, '_blank');
            }
        }
        
        // Original function for toggling contact info
        function toggleContact(button) {
            const jobCard = button.closest('.job-card');
            const contactInfo = jobCard.querySelector('.contact-info');
            
            if (contactInfo.style.display === 'block') {
                contactInfo.style.display = 'none';
                button.textContent = 'Contact Employer';
            } else {
                contactInfo.style.display = 'block';
                button.textContent = 'Hide Contact Info';
            }
        }
        
        // Function for handling job submission
        function handleSubmit() {
            alert('Your application has been submitted successfully!');
        }
    </script>
</body>
</html>